ame: IntegraciÃ³n Continua (CI)

on:
push:
# Esta acciÃ³n se dispara al subir cÃ³digo a estas ramas
branches: [ "main", "develop", "sebas_test" ]
pull_request:
# Esta acciÃ³n se dispara al abrir un PR dirigido a estas ramas
branches: [ "main", "develop" ]
workflow_dispatch: # Permite ejecutar el workflow manualmente

jobs:
build_and_test:
runs-on: ubuntu-latest # Usamos el runner de GitHub

steps:
- name: ğŸ“¥ Clonar Repositorio
  uses: actions/checkout@v4

- name: ğŸ—ï¸ Levantar la AplicaciÃ³n y Servicios con Docker Compose
  # Este comando lee el docker-compose.yml, construye las imÃ¡genes y espera a que levanten
  run: docker-compose up -d --build --wait

- name: â³ Esperar un momento adicional para la inicializaciÃ³n de la BD
  # Damos tiempo extra a MariaDB para la configuraciÃ³n inicial
  run: sleep 15

- name: ğŸ§ª Ejecutar Pruebas (AJUSTAR COMANDO PHP)
  # âš ï¸ RECUERDA: Reemplaza 'vendor/bin/phpunit' por el comando correcto de tu framework.
  run: docker-compose exec -T web vendor/bin/phpunit
      
- name: ğŸ›‘ Limpiar y Detener Contenedores
  # El 'if: always()' garantiza que los contenedores se detengan para liberar recursos
  if: always() 
  run: docker-compose down
